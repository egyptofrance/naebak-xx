# ุงูุฅุตูุงุญ ุงูููุงุฆู: Pagination ุงูููุงุทููู ู Scroll ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ

## ุงูุชุงุฑูุฎ ูุงูููุช
21 ุฃูุชูุจุฑ 2025

## ุงููุดุงูู ุงููุญุฏุฏุฉ

### ุงููุดููุฉ ุงูุฃููู: Pagination ุงูููุงุทููู - ุตูุญุงุช ูุงุฑุบุฉ

**ุงููุตู:**
ุนูุฏ ุชุญููู ููุงุทููู ุฅูู ููุงุจุ ูุงูุช ุชุธูุฑ ุตูุญุงุช ูุงุฑุบุฉ ูู ูุงุฆูุฉ ุงูููุงุทููู. ูุซูุงู:
- ูู ูููุช ูู ุงูููุงุทููู ูู ุฃูู 5 ุตูุญุงุช ุฅูู ููุงุจ
- ุนูุฏ ุงูุฏุฎูู ูุฑุฉ ุฃุฎุฑูุ ุชุฌุฏ ุงูุตูุญุงุช 1-5 ูุงุฑุบุฉ
- ุชุถุทุฑ ุชููุจ ูู ุตูุญุงุช ูุงุฑุบุฉ ูููุตูู ููููุงุทููู ุงููุชุจูููู

**ุงูุณุจุจ:**
ุงูููุฏ ุงููุฏูู ูุงู ูุนูู pagination ุนูู **ูู ุงููุณุชุฎุฏููู** (ููุงุทููู + ููุงุจ)ุ ุซู ูููุชุฑ ุงูููุงุจ ุจุนุฏ ุฐูู:
```typescript
// pagination ุนูู ูู ุงููุณุชุฎุฏููู
.range(startIndex, endIndex)  // ุตูุญุฉ 1 = ูุณุชุฎุฏููู 0-19

// ุซู ุงูููุชุฑุฉ
const filteredData = data?.filter(user => !hasDeputyRole);
// ูู ูู ุงูู 20 ููุงุจุ ุงูุตูุญุฉ ุชุจูู ูุงุถูุฉ!
```

**ุงููุดููุฉ:**
- ุงูุตูุญุฉ 1 ูุฏ ุชุญุชูู ุนูู 20 ูุงุฆุจ โ ุชุธูุฑ ูุงุถูุฉ
- ุงูุตูุญุฉ 2 ูุฏ ุชุญุชูู ุนูู 15 ูุงุฆุจ ู 5 ููุงุทููู โ ุชุธูุฑ 5 ููุท
- ุชุฌุฑุจุฉ ูุณุชุฎุฏู ุณูุฆุฉ ุฌุฏุงู

### ุงููุดููุฉ ุงูุซุงููุฉ: Scroll ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ

**ุงููุตู:**
ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ ูุงูุช ุชุณุชุฎุฏู scroll ุงูุตูุญุฉ ุจุงููุงูู ุจุฏูุงู ูู scroll ูุณุชูู.

## ุงูุญููู ุงููุทุจูุฉ

### โ ุงูุญู ุงูุฃูู: Pagination ุตุญูุญ ุนูู ุงูููุงุทููู ููุท

**ุงูููู:** `src/data/admin/user.tsx`

**ุงูููุทู ุงูุฌุฏูุฏ:**
1. ุฌูุจ **ูู** ุงููุณุชุฎุฏููู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
2. ููุชุฑุฉ ุงูููุงุจ ูู ุงููุชุงุฆุฌ
3. ุชุทุจูู pagination ุนูู **ุงูููุงุทููู ููุท**

```typescript
// 1. ุฌูุจ ูู ุงููุณุชุฎุฏููู
const { data, error } = await supabaseQuery;

// 2. ููุชุฑุฉ ุงูููุงุจ
const filteredData = data?.filter(user => {
  const hasDeputyRole = user.user_roles?.some((role: any) => role.role === "deputy");
  return !hasDeputyRole;
}) || [];

// 3. pagination ุนูู ุงูููุงุทููู ููุท
const startIndex = (page - 1) * limit;
const endIndex = startIndex + limit;
const paginatedData = filteredData.slice(startIndex, endIndex);
```

**ุงููุชูุฌุฉ:**
- โ ุงูุตูุญุฉ 1 ุชุนุฑุถ ุฃูู 20 ููุงุทู (ูู ุงูููุงุทููู ููุท)
- โ ุงูุตูุญุฉ 2 ุชุนุฑุถ ุงูููุงุทููู 21-40
- โ ูุง ุชูุฌุฏ ุตูุญุงุช ูุงุฑุบุฉ ุฃุจุฏุงู
- โ ุชุฌุฑุจุฉ ูุณุชุฎุฏู ููุชุงุฒุฉ

**ูุซุงู ุนููู:**
- ุฅุฌูุงูู ุงููุณุชุฎุฏููู: 1000 (700 ููุงุทู + 300 ูุงุฆุจ)
- ุนุฏุฏ ุงูุตูุญุงุช: 35 ุตูุญุฉ (700 รท 20)
- ูู ุตูุญุฉ ุชุนุฑุถ 20 ููุงุทู ุจุงูุถุจุท
- ุงูุตูุญุฉ ุงูุฃุฎูุฑุฉ ุชุนุฑุถ 20 ููุงุทู (ููุณ 2 ุฃู 5)

### โ ุงูุญู ุงูุซุงูู: Scroll ุฑุฃุณู ูุณุชูู ูููุงุฆูุฉ

**ุงูููู:** `src/components/ui/sidebar.tsx`

**ุงูุชุนุฏูู:**
```typescript
// ูุจู
className="... overflow-auto ..."

// ุจุนุฏ
className="... overflow-y-auto overflow-x-hidden max-h-[calc(100vh-8rem)] ..."
```

**ุงููุชูุฌุฉ:**
- โ ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ ููุง scroll ุฑุฃุณู ูุณุชูู
- โ ูุง ุญุงุฌุฉ ูุชุญุฑูู scroll ุงูุตูุญุฉ ุจุงููุงูู
- โ ุชุฌุฑุจุฉ ูุดุงุจูุฉ ููู scroll ุงูุฃููู ูู ุงูุฌุฏุงูู

## ุงููุฑู ุจูู ุงูุญู ุงููุฏูู ูุงูุฌุฏูุฏ

### ุงูุญู ุงููุฏูู (ุฎุงุทุฆ):
```
ูุงุนุฏุฉ ุงูุจูุงูุงุช: [ููุงุทู1, ูุงุฆุจ1, ูุงุฆุจ2, ..., ูุงุฆุจ18, ููุงุทู2, ููุงุทู3]
                   โ pagination ุฃููุงู (ุฃูู 20)
                   [ููุงุทู1, ูุงุฆุจ1, ูุงุฆุจ2, ..., ูุงุฆุจ18, ููุงุทู2]
                   โ ููุชุฑุฉ ุงูููุงุจ
                   [ููุงุทู1, ููุงุทู2]  โ ุงูุตูุญุฉ ุชุนุฑุถ 2 ููุท! โ
```

### ุงูุญู ุงูุฌุฏูุฏ (ุตุญูุญ):
```
ูุงุนุฏุฉ ุงูุจูุงูุงุช: [ููุงุทู1, ูุงุฆุจ1, ูุงุฆุจ2, ..., ููุงุทู2, ููุงุทู3, ..., ููุงุทู50]
                   โ ุฌูุจ ุงููู
                   โ ููุชุฑุฉ ุงูููุงุจ ุฃููุงู
                   [ููุงุทู1, ููุงุทู2, ููุงุทู3, ..., ููุงุทู50]
                   โ pagination ุนูู ุงูููุงุทููู ููุท
                   [ููุงุทู1, ููุงุทู2, ..., ููุงุทู20]  โ ุงูุตูุญุฉ ุชุนุฑุถ 20 โ
```

## ุงูุฃุฏุงุก

**ุณุคุงู:** ูู ุฌูุจ ูู ุงููุณุชุฎุฏููู ูุคุซุฑ ุนูู ุงูุฃุฏุงุกุ

**ุงูุฌูุงุจ:**
- ูู ูุนุธู ุงูุชุทุจููุงุชุ ุนุฏุฏ ุงููุณุชุฎุฏููู ูุนููู (ุขูุงูุ ููุณ ููุงููู)
- Supabase ูุฌูุจ ุงูุจูุงูุงุช ุจุณุฑุนุฉ ุนุงููุฉ
- ุงูููุชุฑุฉ ูู JavaScript ุณุฑูุนุฉ ุฌุฏุงู
- ุงูุจุฏูู (ุงุณุชุนูุงูุงุช ูุนูุฏุฉ) ูุฏ ูููู ุฃุจุทุฃ
- ุฅุฐุง ูุงู ุงูุนุฏุฏ ูุจูุฑ ุฌุฏุงูุ ูููู ุงุณุชุฎุฏุงู Supabase RPC ูุงุญูุงู

## ูุนูููุงุช ุงูููููุช

**Commit Hash:** `e4671b5`  
**Commit Message:** "fix: Correct users pagination and add sidebar vertical scroll"

### ุงูุชูุงุตูู:
```
Pagination Fix:
- Fetch ALL users first, filter out deputies, then paginate
- This ensures each page shows exactly 20 citizens (or specified limit)
- No more empty pages when deputies are promoted
- Pagination now works on citizens only, not all users

Sidebar Scroll:
- Add independent vertical scroll to sidebar content
- Change overflow-auto to overflow-y-auto with max-h-[calc(100vh-8rem)]
- Sidebar now has its own scroll instead of using page scroll
- Better UX similar to horizontal scroll in tables
```

## ุงููููุงุช ุงููุนุฏูุฉ

1. **src/data/admin/user.tsx**
   - ุชุนุฏูู `getPaginatedUserListAction`:
     - ุฅุฒุงูุฉ `.limit()` ู `.range()` ูู ุงูุงุณุชุนูุงู
     - ุฌูุจ ูู ุงููุณุชุฎุฏููู
     - ููุชุฑุฉ ุงูููุงุจ
     - ุชุทุจูู pagination ูู JavaScript
   - `getUsersTotalPagesAction` ูู ูุชุบูุฑ (ูุงู ุตุญูุญุงู)

2. **src/components/ui/sidebar.tsx**
   - ุชุนุฏูู `SidebarContent`:
     - `overflow-auto` โ `overflow-y-auto overflow-x-hidden`
     - ุฅุถุงูุฉ `max-h-[calc(100vh-8rem)]`

## ุงูุงุฎุชุจุงุฑ

### ุงุฎุชุจุงุฑ Pagination:
1. โ ุงูุชุญ `/app_admin/users`
2. โ ุชุญูู ูู ุฃู ุงูุตูุญุฉ 1 ุชุนุฑุถ 20 ููุงุทู
3. โ ุญูู ุจุนุถ ุงูููุงุทููู ูู ุงูุตูุญุฉ 1 ุฅูู ููุงุจ
4. โ ุฃุนุฏ ุชุญููู ุงูุตูุญุฉ
5. โ ุชุฃูุฏ ุฃู ุงูุตูุญุฉ 1 ูุง ุชุฒุงู ุชุนุฑุถ 20 ููุงุทู (ูุฎุชูููู)
6. โ ูุง ุชูุฌุฏ ุตูุญุงุช ูุงุฑุบุฉ

### ุงุฎุชุจุงุฑ Scroll:
1. โ ุงูุชุญ ุฃู ุตูุญุฉ ูู ููุญุฉ ุงูุฃุฏูู
2. โ ุญุฑู scroll ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ
3. โ ุชุฃูุฏ ุฃู ุงููุญุชูู ุงูุฑุฆูุณู ูุง ูุชุญุฑู
4. โ Scroll ุณูุณ ููุณุชูู

## ุงูุญุงูุฉ ุงูุญุงููุฉ

โ **ุชู ุฑูุน ุงูุชุบููุฑุงุช ุจูุฌุงุญ ุฅูู GitHub**
- ุงููุฑุน: main
- ุงูุญุงูุฉ: ูุชุฒุงูู ูุน origin/main
- Vercel ุณูููู ุจุนูู deployment ุชููุงุฆู

## ููุงุญุธุงุช ูููุฉ

### ููุงุฐุง ูุฐุง ุงูุญู ุฃูุถูุ

1. **ุจุณุงุทุฉ ุงูููุฏ:**
   - ููุทู ูุงุถุญ ููุจุงุดุฑ
   - ุณูู ุงูููู ูุงูุตูุงูุฉ
   - ูุง ูุญุชุงุฌ ุงุณุชุนูุงูุงุช ูุนูุฏุฉ

2. **ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู:**
   - ูุง ุชูุฌุฏ ุตูุญุงุช ูุงุฑุบุฉ ุฃุจุฏุงู
   - ูู ุตูุญุฉ ุชุนุฑุถ ุงูุนุฏุฏ ุงููุงูู
   - ุงูุชููู ุจูู ุงูุตูุญุงุช ููุทูู

3. **ุงููุฑููุฉ:**
   - ูุนูู ูุน ุฃู ููุงุชุฑ ุฅุถุงููุฉ
   - ุณูู ุงูุชุนุฏูู ูุงุญูุงู
   - ูุชูุงูู ูุน ุงูุจุญุซ ูุงูููุชุฑุฉ

### ูุชู ูุญุชุงุฌ ุญู ูุฎุชููุ

ุฅุฐุง ูุงู ุนุฏุฏ ุงููุณุชุฎุฏููู **ุถุฎู ุฌุฏุงู** (ูุฆุงุช ุงูุขูุงู ุฃู ููุงููู)ุ ูููู:
1. ุงุณุชุฎุฏุงู Supabase RPC (stored procedure)
2. ุฅูุดุงุก view ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุณุชุจุนุฏ ุงูููุงุจ
3. ุงุณุชุฎุฏุงู materialized view ููุฃุฏุงุก ุงูุฃูุถู

ููู ููุชุทุจูู ุงูุญุงููุ ุงูุญู ุงูุญุงูู **ูุซุงูู**.

## ุงูุฎูุงุตุฉ

โ **ุงููุดููุฉ:** ุตูุญุงุช ูุงุฑุบุฉ ุนูุฏ ุชุญููู ููุงุทููู ุฅูู ููุงุจ  
โ **ุงูุญู:** pagination ุนูู ุงูููุงุทููู ููุทุ ููุณ ุนูู ูู ุงููุณุชุฎุฏููู  
โ **ุงููุชูุฌุฉ:** ูู ุตูุญุฉ ุชุนุฑุถ 20 ููุงุทู ุจุงูุถุจุทุ ูุง ุชูุฌุฏ ุตูุญุงุช ูุงุฑุบุฉ  

โ **ุงููุดููุฉ:** ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ ุชุณุชุฎุฏู scroll ุงูุตูุญุฉ  
โ **ุงูุญู:** ุฅุถุงูุฉ scroll ูุณุชูู ูููุงุฆูุฉ  
โ **ุงููุชูุฌุฉ:** ุชุฌุฑุจุฉ ูุณุชุฎุฏู ุฃูุถู ูุฃูุซุฑ ุงุญุชุฑุงููุฉ  

๐ **ุงูุชุทุจูู ุงูุขู ูุนูู ุจุดูู ุตุญูุญ ูููุทูู!**

