#!/usr/bin/env python3
"""
Check governorate names in Excel and create a mapping/fix script
"""

import pandas as pd
import os

# Read the Excel file
excel_file = '/home/ubuntu/naebak-xx/data/ุฌููุนุงููุฑุดุญูู.xlsx'

print("\n" + "="*80)
print("๐ ูุญุต ุฃุณูุงุก ุงููุญุงูุธุงุช ูู ููู Excel")
print("="*80 + "\n")

# Read Excel
df = pd.read_excel(excel_file)

# Get unique governorate names
unique_governorates = df['ุงููุญุงูุธุฉ'].unique()

print(f"๐ ุนุฏุฏ ุงููุญุงูุธุงุช ุงููุฑูุฏุฉ ูู ุงูููู: {len(unique_governorates)}\n")
print("๐ ูุงุฆูุฉ ุงููุญุงูุธุงุช:")
print("-" * 80)
for i, gov in enumerate(sorted(unique_governorates), 1):
    count = len(df[df['ุงููุญุงูุธุฉ'] == gov])
    print(f"{i:2}. {gov:30} ({count:4} ูุฑุดุญ)")
print("-" * 80)

# ุงูุฃุณูุงุก ุงูุตุญูุญุฉ ูููุญุงูุธุงุช (ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช)
CORRECT_GOVERNORATES = {
    'ุงูุฅุณููุฏุฑูุฉ': 'ุงูุฅุณููุฏุฑูุฉ',
    'ุงูุฅุณูุงุนูููุฉ': 'ุงูุฅุณูุงุนูููุฉ',
    'ุฃุณูุงู': 'ุฃุณูุงู',
    'ุฃุณููุท': 'ุฃุณููุท',
    'ุงูุฃูุตุฑ': 'ุงูุฃูุตุฑ',
    'ุงูุจุญุฑ ุงูุฃุญูุฑ': 'ุงูุจุญุฑ ุงูุฃุญูุฑ',
    'ุงูุจุญูุฑุฉ': 'ุงูุจุญูุฑุฉ',
    'ุจูู ุณููู': 'ุจูู ุณููู',
    'ุจูุฑุณุนูุฏ': 'ุจูุฑุณุนูุฏ',
    'ุฌููุจ ุณููุงุก': 'ุฌููุจ ุณููุงุก',
    'ุงูุฌูุฒุฉ': 'ุงูุฌูุฒุฉ',
    'ุงูุฏููููุฉ': 'ุงูุฏููููุฉ',
    'ุฏููุงุท': 'ุฏููุงุท',
    'ุณููุงุฌ': 'ุณููุงุฌ',
    'ุงูุณููุณ': 'ุงูุณููุณ',
    'ุงูุดุฑููุฉ': 'ุงูุดุฑููุฉ',
    'ุดูุงู ุณููุงุก': 'ุดูุงู ุณููุงุก',
    'ุงูุบุฑุจูุฉ': 'ุงูุบุฑุจูุฉ',
    'ุงููููู': 'ุงููููู',
    'ุงููุงูุฑุฉ': 'ุงููุงูุฑุฉ',
    'ุงูููููุจูุฉ': 'ุงูููููุจูุฉ',
    'ููุง': 'ููุง',
    'ููุฑ ุงูุดูุฎ': 'ููุฑ ุงูุดูุฎ',
    'ูุทุฑูุญ': 'ูุทุฑูุญ',
    'ุงููููููุฉ': 'ุงููููููุฉ',
    'ุงููููุง': 'ุงููููุง',
    'ุงููุงุฏู ุงูุฌุฏูุฏ': 'ุงููุงุฏู ุงูุฌุฏูุฏ',
}

# Mapping for incorrect names
GOVERNORATE_MAPPING = {
    'ุงูุจุญุฑ ุงูุงุญูุฑ': 'ุงูุจุญุฑ ุงูุฃุญูุฑ',
    'ุงูุฌูุฒู': 'ุงูุฌูุฒุฉ',
    'ุงูุงุณููุฏุฑูุฉ': 'ุงูุฅุณููุฏุฑูุฉ',
    'ุงูุงุณูุงุนูููุฉ': 'ุงูุฅุณูุงุนูููุฉ',
    'ุงูุงูุตุฑ': 'ุงูุฃูุตุฑ',
}

print("\n" + "="*80)
print("๐ง ุงูุฃุณูุงุก ุงูุชู ุชุญุชุงุฌ ุชุตุญูุญ:")
print("="*80 + "\n")

needs_fix = []
for gov in unique_governorates:
    if gov in GOVERNORATE_MAPPING:
        correct_name = GOVERNORATE_MAPPING[gov]
        count = len(df[df['ุงููุญุงูุธุฉ'] == gov])
        print(f"  โ '{gov}' โ โ '{correct_name}' ({count} ูุฑุดุญ)")
        needs_fix.append((gov, correct_name, count))
    elif gov not in CORRECT_GOVERNORATES:
        count = len(df[df['ุงููุญุงูุธุฉ'] == gov])
        print(f"  โ๏ธ  '{gov}' - ุงุณู ุบูุฑ ูุนุฑูู ({count} ูุฑุดุญ)")
        needs_fix.append((gov, None, count))

if not needs_fix:
    print("  โ ุฌููุน ุงูุฃุณูุงุก ุตุญูุญุฉ!")
else:
    print(f"\n๐ ุฅุฌูุงูู ุงูุฃุณูุงุก ุงูุชู ุชุญุชุงุฌ ุชุตุญูุญ: {len(needs_fix)}")
    total_affected = sum([x[2] for x in needs_fix])
    print(f"๐ ุฅุฌูุงูู ุงููุฑุดุญูู ุงููุชุฃุซุฑูู: {total_affected}")

print("\n" + "="*80)
print("๐ก ูู ุชุฑูุฏ ุชุตุญูุญ ุงูุฃุณูุงุก ูู ููู Excelุ")
print("="*80 + "\n")

