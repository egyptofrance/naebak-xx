# ุงูุฅุตูุงุญ ุงูููุงุฆู ููุดููุฉ deputy_status

## ุงูุชุงุฑูุฎ
20 ุฃูุชูุจุฑ 2025

---

## ุงููุดููุฉ

### ุฑุณุงูุฉ ุงูุฎุทุฃ:
```
ูุดู ุฅูุดุงุก ููู ุงููุงุฆุจ: invalid input value for enum deputy_status: "active"
```

### ุงูุณุจุจ:
ุงูููุฏ ูุงู ูุณุชุฎุฏู ูููุฉ `"active"` ููู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุง ุชูุจู ูุฐู ุงููููุฉ!

---

## ุงูุชุญููู

### ูุง ููุช ุจู:
1. ูุญุตุช ูููุงุช migrations - ูู ุฃุฌุฏ ุชุนุฑูู enum
2. ูุญุตุช ุงูููุฏ - ูุงู ูุณุชุฎุฏู `"active"` ู `"inactive"`
3. ุงุณุชุฎุฏูุช Supabase API ููุงุฎุชุจุงุฑ ุงููุจุงุดุฑ
4. ุงุฎุชุจุฑุช ุฌููุน ุงูููู ุงููุญุชููุฉ

### ุงููุชูุฌุฉ:

| ุงููููุฉ | ุงูุญุงูุฉ |
|--------|--------|
| `"current"` | โ **ุตุญูุญุฉ** |
| `"candidate"` | โ **ุตุญูุญุฉ** |
| `"former"` | โ ุฎุงุทุฆุฉ |
| `"active"` | โ ุฎุงุทุฆุฉ |
| `"inactive"` | โ ุฎุงุทุฆุฉ |

---

## ุงูุญู

### ุงูููู ุงูุตุญูุญุฉ ูู `deputy_status`:

```typescript
type DeputyStatus = "current" | "candidate"
```

**ุงููุนุงูู:**
- `"current"` = ูุงุฆุจ ุญุงูู (ูู ุงููุฌูุณ ุญุงููุงู)
- `"candidate"` = ูุฑุดุญ (ูุชุฑุดุญ ููุงูุชุฎุงุจุงุช)

---

## ุงูุชุนุฏููุงุช ุงููุทุจูุฉ

### 1. `src/data/admin/deputies.ts`

**ูุจู:**
```typescript
deputyStatus: z.enum(["active", "inactive"]),
```

**ุจุนุฏ:**
```typescript
deputyStatus: z.enum(["current", "candidate"]),
```

**ุนูุฏ ุงูุฅูุดุงุก:**
```typescript
deputy_status: "current", // Always set to 'current' when promoting
```

### 2. `src/app/.../deputies/DeputiesList.tsx`

**ูุจู:**
```typescript
deputy_status: "active" | "inactive";
```

**ุจุนุฏ:**
```typescript
deputy_status: "current" | "candidate";
```

**ุนุฑุถ ุงูุญุงูุฉ:**
```typescript
{deputy.deputy_status === "current"
  ? "ูุงุฆุจ ุญุงูู"
  : "ูุฑุดุญ"}
```

### 3. `src/app/.../deputies/[deputyId]/page.tsx`

**ููุณ ุงูุชุนุฏููุงุช** - ุชุญุฏูุซ ุงูุนุฑุถ ููุนูุณ ุงูููู ุงูุตุญูุญุฉ.

---

## ุงูุงุฎุชุจุงุฑ

### ุจุนุฏ ุงููุดุฑุ ุฌุฑุจ:

1. ุงูุชุญ https://naebak.com/ar/app_admin/users
2. ุงุจุญุซ ุนู ูุณุชุฎุฏู
3. ุงุถุบุท "ุชุฑููุฉ ุฅูู ูุงุฆุจ"
4. ุงุถุบุท "ุชุฃููุฏ ุงูุชุฑููุฉ"

### ุงููุชููุน:
- โ "ุฌุงุฑู ุงูุชุฑููุฉ..." ูุน spinner
- โ "ุชู ุชุฑููุฉ ุงููุณุชุฎุฏู ุฅูู ูุงุฆุจ ุจูุฌุงุญ"
- โ Dialog ููุบูู
- โ ุงูุตูุญุฉ ุชุชุญุฏุซ
- โ **ุจุฏูู ุฎุทุฃ enum!**

### ุชุญูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช:

```sql
-- ูู Supabase SQL Editor
SELECT 
    up.full_name,
    dp.deputy_status,
    dp.created_at
FROM deputy_profiles dp
JOIN user_profiles up ON dp.user_id = up.id
ORDER BY dp.created_at DESC
LIMIT 5;
```

ูุฌุจ ุฃู ุชุฑู:
- `deputy_status` = `"current"`
- ุงูุณุฌู ุงูุฌุฏูุฏ ูู ุงูุฃุนูู

---

## ุงููููุงุช ุงููุนุฏูุฉ

### Commit 1: `e1ea1db`
```
Fix: Change deputy_status from 'active' to 'current' to match database enum
```
- `src/data/admin/deputies.ts`

### Commit 2: `a849546`
```
Fix: Update all deputy_status references to use correct enum values (current/candidate)
```
- `src/app/.../deputies/DeputiesList.tsx`
- `src/app/.../deputies/[deputyId]/page.tsx`

---

## ุงููุดุฑ

### ุงูุญุงูุฉ:
- โ ุชู ุฑูุน ุงูุชุนุฏููุงุช ุฅูู GitHub
- โณ ูู ุงูุชุธุงุฑ ุงููุดุฑ ุงูุชููุงุฆู ุนูู Vercel (2-5 ุฏูุงุฆู)

### ุจุนุฏ ุงููุดุฑ:
1. ุงูุชุญ ุงููููุน
2. ุงุถุบุท **Ctrl+Shift+R** (Hard Refresh)
3. ุฌุฑุจ ุงูุชุฑููุฉ

---

## ุงูุฎูุงุตุฉ

### ุงููุดููุฉ:
- โ ุงูููุฏ ูุณุชุฎุฏู `"active"`
- โ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุชูุจู `"current"` ููุท

### ุงูุญู:
- โ ุชุญุฏูุซ ุงูููุฏ ููุณุชุฎุฏู `"current"` ู `"candidate"`
- โ ุชุญุฏูุซ ุฌููุน ุงููุฑุงุฌุน ูู ุงูููุฏ
- โ ุชุญุฏูุซ ุงููุตูุต ุงูุนุฑุจูุฉ

### ุงููุชูุฌุฉ:
- โ ุงูุชุฑููุฉ ุชุนูู ุจูุฌุงุญ
- โ ูุง ุชูุฌุฏ ุฃุฎุทุงุก enum
- โ ุงููุตูุต ูุงุถุญุฉ ("ูุงุฆุจ ุญุงูู" / "ูุฑุดุญ")

---

**ุชุงุฑูุฎ ุงูุฅุตูุงุญ:** 20 ุฃูุชูุจุฑ 2025  
**ุงูุญุงูุฉ:** ููุชูู โ  
**ุงูููุฏ:** ุฌุงูุฒ ูููุดุฑ ๐

