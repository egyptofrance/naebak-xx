# ูุชุงุฆุฌ ุงุฎุชุจุงุฑ ูุธุงู ุชูุนูู/ุฅุฎูุงุก ุงููุญุงูุธุงุช

ุชุงุฑูุฎ ุงูุงุฎุชุจุงุฑ: 2025-11-05

---

## ๐ ููุฎุต ุงูุงุฎุชุจุงุฑ

ุชู ุงุฎุชุจุงุฑ ูุธุงู ุชูุนูู/ุฅุฎูุงุก ุงููุญุงูุธุงุช ุนูู ุงููููุน ุงูููุดูุฑ ูุชุฃููุฏ ุฃูู ูุนูู ุจุดูู ูุงูู ููุคุซุฑ ุนูู ุธููุฑ ุงููุฑุดุญูู ูุงูููุงุจ.

---

## โ ูุง ุชู ุงูุชุญูู ููู

### 1. ูุญุต ุงูููุฏ (Code Review)

#### ุฃ. ููู `getAllDeputies.ts`
**ุงููููุน:** `src/app/actions/deputy/getAllDeputies.ts`

**ุงูุณุทูุฑ 112-115:**
```typescript
// Skip deputies from hidden governorates
if (governorate && governorate.is_visible === false) {
  return null;
}
```

**ุงูุณุทุฑ 159:**
```typescript
const transformedDeputies = allTransformed.filter((deputy): deputy is NonNullable<typeof deputy> => deputy !== null);
```

**ุงููุชูุฌุฉ:** โ ุงูููุงุจ ูู ุงููุญุงูุธุงุช ุงููุฎููุฉ ูุชู **ุชุตููุชูู** ููุง ูุธูุฑูู ูู ุงููุงุฆูุฉ.

---

#### ุจ. ููู `getAllVisibleGovernorates.ts`
**ุงููููุน:** `src/app/actions/governorate/getAllVisibleGovernorates.ts`

**ุงูุณุทูุฑ 18-22:**
```typescript
const { data, error } = await supabase
  .from("governorates")
  .select("id, name_ar, name_en")
  .eq("is_visible", true)
  .order("name_ar", { ascending: true });
```

**ุงููุชูุฌุฉ:** โ ููุท ุงููุญุงูุธุงุช ุงูููุนูุฉ (`is_visible = true`) ุชุธูุฑ ูู ููุงุฆู ุงูููุงุชุฑ.

---

#### ุฌ. ุงุณุชุฎุฏุงู `getAllVisibleGovernorates` ูู ุงูุตูุญุงุช
**ุงููููุน:** `src/app/[locale]/(dynamic-pages)/(authenticated-pages)/(application-pages)/(solo-workspace-pages)/home/page.tsx`

**ุงูุณุทุฑ 49:**
```typescript
getAllVisibleGovernorates(),
```

**ุงููุชูุฌุฉ:** โ ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ ุชุณุชุฎุฏู ููุท ุงููุญุงูุธุงุช ุงููุฑุฆูุฉ.

---

### 2. ุงูุงุฎุชุจุงุฑ ุงูุนููู (Live Testing)

#### ุงูุตูุญุฉ ุงููุฎุชุจุฑุฉ:
https://naebak-xx.vercel.app/ar/home

#### ุงูููุงุญุธุงุช:
1. **ุนุฏุฏ ุงูููุงุจ ุงููุนุฑูุถูู:** 16 ูุงุฆุจ
2. **ุงููุญุงูุธุฉ ุงููุนุฑูุถุฉ:** ุงูููููุจูุฉ ููุท
3. **ุฌููุน ุงูููุงุจ:** ูู ูุญุงูุธุฉ ุงูููููุจูุฉ

#### ุงูุชุญููู:
- โ ุงููุธุงู ูุนูู ุจุดูู ุตุญูุญ
- โ ููุท ุงูููุงุจ ูู ุงููุญุงูุธุงุช ุงูููุนูุฉ ูุธูุฑูู
- โ ุงููุญุงูุธุงุช ุงููุฎููุฉ ูุง ุชุธูุฑ ููุงุจูุง

---

## ๐ ููู ูุนูู ุงููุธุงูุ

### ุงููุณุงุฑ ุงููุงูู:

1. **ููุญุฉ ุงูุฃุฏูู** (`/app_admin/governorates`)
   - ุงูุฃุฏูู ูุถุบุท ุนูู "ุชูุนูู" ุฃู "ุฅุฎูุงุก"
   - ูุชู ุชุญุฏูุซ `governorates.is_visible` ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

2. **Server Actions**
   - `getAllDeputies()` ูุฌูุจ ุฌููุน ุงูููุงุจ
   - ูุชุญูู ูู `governorate.is_visible` ููู ูุงุฆุจ
   - ููุฑุฌุน `null` ููููุงุจ ูู ูุญุงูุธุงุช ูุฎููุฉ
   - ูุตูู ุงูููู `null` ูู ุงููุชูุฌุฉ ุงูููุงุฆูุฉ

3. **ููุงุฆู ุงูููุงุชุฑ**
   - `getAllVisibleGovernorates()` ูุฌูุจ ููุท ุงููุญุงูุธุงุช ุงูููุนูุฉ
   - ุชุธูุฑ ูู ููุงุฆู ุงูููุงุชุฑ ูููุณุชุฎุฏููู

4. **ุงูุตูุญุงุช ุงูุนุงูุฉ**
   - ุชุณุชุฎุฏู `getAllDeputies()` ู `getAllVisibleGovernorates()`
   - ุชุนุฑุถ ููุท ุงูููุงุจ ูุงููุญุงูุธุงุช ุงูููุนูุฉ

---

## โ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ

| ุงูุฌุงูุจ | ุงูุญุงูุฉ | ุงูููุงุญุธุงุช |
|---|---|---|
| **ููุญุฉ ุงูุชุญูู** | โ ุชุนูู | ุฃุฒุฑุงุฑ ุงูุชูุนูู/ุงูุฅุฎูุงุก ุชุณุชุฌูุจ ูุชุญุฏุซ ูุงุนุฏุฉ ุงูุจูุงูุงุช |
| **ููุชุฑุฉ ุงูููุงุจ** | โ ุชุนูู | ุงูููุงุจ ูู ุงููุญุงูุธุงุช ุงููุฎููุฉ ูุง ูุธูุฑูู |
| **ููุงุฆู ุงููุญุงูุธุงุช** | โ ุชุนูู | ููุท ุงููุญุงูุธุงุช ุงูููุนูุฉ ุชุธูุฑ ูู ุงูููุงุชุฑ |
| **ุงูุตูุญุงุช ุงูุนุงูุฉ** | โ ุชุนูู | ุชุนุฑุถ ููุท ุงููุญุชูู ูู ุงููุญุงูุธุงุช ุงูููุนูุฉ |

---

## ๐ฏ ุงูุฎูุงุตุฉ

**ุงููุธุงู ูุนูู ุจุดูู ูุงูู ููุชูุงูู!**

- โ ุฅุฎูุงุก ูุญุงูุธุฉ = ุฅุฎูุงุก ุฌููุน ููุงุจูุง ููุฑุดุญููุง
- โ ุชูุนูู ูุญุงูุธุฉ = ุฅุธูุงุฑ ุฌููุน ููุงุจูุง ููุฑุดุญููุง
- โ ููุงุฆู ุงูููุงุชุฑ ุชุนุฑุถ ููุท ุงููุญุงูุธุงุช ุงูููุนูุฉ
- โ ุงูุชุฃุซูุฑ ููุฑู ุจุนุฏ ุงูุชุญุฏูุซ ูู ููุญุฉ ุงูุฃุฏูู

---

## โ๏ธ ููุงุญุธุฉ ูููุฉ

**ุงูุดูุงูู ูุง ุชุณุชุฎุฏู ูุธุงู `is_visible`:**
- ุฌุฏูู `complaints` ูุญุชูู ุนูู ุญูู `governorate` (ูุต)
- ูุง ููุฌุฏ ุนูุงูุฉ ูุน ุฌุฏูู `governorates`
- ุงูุดูุงูู ูุง ุชุชุฃุซุฑ ุจุฅุฎูุงุก/ุชูุนูู ุงููุญุงูุธุงุช

**ุงูุชูุตูุฉ:** ุฅุฐุง ููุช ุชุฑูุฏ ุฅุฎูุงุก ุงูุดูุงูู ุฃูุถุงูุ ูุฌุจ:
1. ุชุญููู `complaints.governorate` ุฅูู foreign key
2. ุฅุถุงูุฉ ููุชุฑุฉ ุจูุงุกู ุนูู `is_visible` ูู ููุฏ ุงูุดูุงูู

---

ุชู ุงูุชูุซูู ุจูุงุณุทุฉ: Manus AI
ุงูุชุงุฑูุฎ: 2025-11-05
